<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileOverview
 */
const express = require("express");
const request = require("request");
const rp = require("request-promise");
const mongoose = require("mongoose");
const hbs = require("express-handlebars");
const extractor = require("./lib/extractor");
const airDataModel = require("./models/airData");
const app = express();
const Chart = require("chart.js");
/**
 * Username to login to the database
 */
let un = `nrHay`;
/**
 * Password to login to the database
 */
let pw = `m1Database!`;
mongoose.connect(
  `mongodb+srv://${un}:${pw}@cluster0-qdloe.gcp.mongodb.net/test?retryWrites=true&amp;w=majority`
);

app.engine("handlebars", hbs());
app.set("view engine", "handlebars");
app.get("/api/data", (req, res) => {
  airDataModel
    .find({})
    .then(data => {
      res.json(data);
    })
    .catch(err => {
      console.log(`Err ${err}`);
      return;
    });
});

/**
 * Retrives AQI data from JSON objects as floating points
 * @param {Object} jsons
 */
function getAQIdata(jsons) {
  result = [];
  for (var i = 0; i &lt; jsons.length; i++) {
    result.push(jsons[i].aq.aqi);
  }
  return result;
}
/**
 * Retrives timestamps from JSON object as epoch seconds
 * @param {Object} jsons
 */
function getAQItimestamps(jsons) {
  result = [];
  for (var i = 0; i &lt; jsons.length; i++) {
    result.push(jsons[i].ts.getTime());
  }
  return result;
}

app.get("/", (req, res) => {
  airDataModel
    .find({})
    .then(data => {
      const returnData = {
        title: "AQI Index",
        data: data,
        AQIdata: getAQIdata(data),
        AQIdates: getAQItimestamps(data)
      };
      res.render("layout", returnData);
    })
    .catch(err => {
      console.log(`Err ${err}`);
      return;
    });
});

app.listen(3000, () => console.log("App started on port 3000"));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#getAQIdata">getAQIdata</a></li><li><a href="global.html#getAQItimestamps">getAQItimestamps</a></li><li><a href="global.html#pw">pw</a></li><li><a href="global.html#un">un</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Mar 10 2020 14:46:42 GMT+1100 (Australian Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
